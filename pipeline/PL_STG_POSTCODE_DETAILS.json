{
	"name": "PL_STG_POSTCODE_DETAILS",
	"properties": {
		"activities": [
			{
				"name": "PostCodeDistricts",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "Local_Authority_Districts.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_LOCAL_AUTHORITY",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_LOCAL_AUTHORITY",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeRegions",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "POSTCODEREGIONS.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_REGIONS",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_REGIONS",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeCounties",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeCounties.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_COUNTIES",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_COUNTIES",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeConstituencies",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeConstituencies.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE\nKNE_STG.POSTCODE_CONSTITUENCIES",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_CONSTITUENCIES",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeNationalPark",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeNationalPark.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE\nKNE_STG.POSTCODE_NATIONAL_PARK",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_NATIONAL_PARK",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodePolice",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodePolice.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_POLICE",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_POLICE",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeTraveltoWork",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeTraveltoWork.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_TRAVEL_TO_WORK",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_TRAVEL_TO_WORK",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeIntegratedHealthBoard",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostcodesIntgratedHealthBoard.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_INTEGRATED_HEALTH_BOARD",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_INTEGRATED_HEALTH_BOARD",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeNHSCCG",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeNHS_CCG.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_NHS_CCG",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_NHS_CCG",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "CD_STG_POSTCODE_DETAILS",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "PostCodeTraveltoWork",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeIntegratedHealthBoard",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeNHSCCG",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodePolice",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeNationalPark",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCode",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeCountry",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeConstituencies",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeRegions",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeDistricts",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeParlConstiUpdate2024",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeMetroCounties",
						"dependencyConditions": [
							"Succeeded"
						]
					},
					{
						"activity": "PostCodeWardsComplete",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "\nWITH\nQ_INT_HEALTH_BOARD\nAS\n( Select DISTINCT SICBL23CD,ICB23NM NHS_INTEGRATED_CARE_BOARD,NHSER23NM NHS_REGION\n from KNE_STG.POSTCODE_INTEGRATED_HEALTH_BOARD),\n\n\nQ_PARL_CONT\nAS\n(  SELECT DISTINCT PC.PCD POSTCODE,\n COALESCE(CONDESC24.PCON24NM,CONDESC.PCON10NM) ACTIVE_CONSTITUENCY\n FROM KNE_STG.POSTCODES PC\n LEFT OUTER JOIN KNE_STG.POSTCODE_CONSTITUENCIES CONDESC\n ON PC.PCON=CONDESC.PCON10CD\n LEFT OUTER JOIN KNE_STG.POSTCODE_PARL_CONSTIT_2024 CON24\n ON REPLACE(PC.pcd,' ','')=REPLACE(CON24.POSTCODE,' ','')\n LEFT OUTER JOIN KNE_STG.POSTCODE_CONSTITUENCIES CONDESC24\n ON CON24.PCON24=CONDESC24.PCON24CD\n AND PC.PCON=CONDESC24.PCON10CD ),\n\n Q_TTW\n AS\n (SELECT \n TTWA11CDN,\n CONVERT(FLOAT,[EMPLOYMENT RATE]) AS EMPLOYMENT_RATE,\n        CONVERT(FLOAT,[MALE EMPLOYMENT RATE]) AS MALE_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[FEMALE EMPLOYMENT RATE]) AS FEMALE_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[SELF EMPLOYMENT RATE])  AS SELF_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE])AS ECONOMICALLY_INACTIVE,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE MALES]) AS ECONOMICALLY_INACTIVE_MALES,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE FEMALES]) AS ECONOMICALLY_INACTIVE_FEMALES,\n\t\tCONVERT(FLOAT,[NVQ LEVEL 4 QUALIFICATIONS])  AS NVQ_LEVEL_4_QUALIFICATIONS,\n\t\tCONVERT(FLOAT,[NVQ No qualifications])  AS NVQ_No_qualifications\n FROM KNE_STG.POSTCODE_TRAVEL_TO_WORK)\n\n\n\n\n\nSELECT  DISTINCT \nPC.PCD AS POSTCODE,\nWD.WD21NM AS WARDNAME,\nLA.LAD22NM AS LOCAL_AUTHORITY,\nCS.ACTIVE_CONSTITUENCY AS PARL_CONSTIT,\nCTY.CTY15NM AS COUNTY,\nRG.RGN14NM AS REGION,\nCOUNTRY.CTRY15NM COUNTRY,\nHB.NHS_INTEGRATED_CARE_BOARD,\nHB.NHS_REGION,\nCCG.CCG18NM NHS_CLINICAL_COMM_GROUP,\nCOALESCE(NP.NPARK16NM, 'Not a National Park') AS NATIONAL_PARK,\nPO.PFA15NM POLICE_AUTHORITY,\nEMPLOYMENT_RATE,\nMALE_EMPLOYMENT_RATE,\nFEMALE_EMPLOYMENT_RATE,\nSELF_EMPLOYMENT_RATE,\nECONOMICALLY_INACTIVE,\nECONOMICALLY_INACTIVE_MALES,\nECONOMICALLY_INACTIVE_FEMALES,\nNVQ_LEVEL_4_QUALIFICATIONS,\nNVQ_No_qualifications,\nPC.LAT   AS LATITUDE,\nPC.LONG AS LONGDITUDE\n\n \n FROM KNE_STG.Postcodes PC\n LEFT OUTER JOIN KNE_STG.POSTCODE_COUNTRY COUNTRY\n ON PC.CTRY=COUNTRY.CTRY15CD\nLEFT OUTER JOIN KNE_STG.POSTCODE_LOCAL_AUTHORITY LA\n ON PC.LAUA=LA.LAD22CD\n LEFT OUTER JOIN KNE_STG.POSTCODE_WARDS WD\n ON PC.WARD=WD.WD21CD\n LEFT OUTER JOIN KNE_STG.POSTCODE_REGIONS RG\n  ON PC.RGN=RG.RGN14CD \n LEFT OUTER JOIN KNE_STG.POSTCODE_COUNTIES CTY\n ON PC.CTY=CTY.CTY15CD\n LEFT OUTER JOIN Q_PARL_CONT CS\n ON PC.PCD=CS.POSTCODE\n LEFT OUTER JOIN KNE_STG.POSTCODE_NATIONAL_PARK NP\n ON PC.NPARK=NP.NPARK16CD\n LEFT OUTER JOIN KNE_STG.POSTCODE_POLICE PO\n ON PC.PFA=PO.PFA15CD\n LEFT OUTER JOIN Q_TTW TTW\n ON PC.TTWA=TTW.TTWA11CDN\n LEFT OUTER JOIN Q_INT_HEALTH_BOARD HB\n ON PC.SICBL=HB.SICBL23CD\n LEFT OUTER JOIN KNE_STG.POSTCODE_NHS_CCG CCG\n ON PC.LSOA21=CCG.LSOA11CD\n\n\n\n SELECT CONVERT(FLOAT,[EMPLOYMENT RATE]) AS EMPLOYMENT_RATE,\n        CONVERT(FLOAT,[MALE EMPLOYMENT RATE]) AS MALE_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[FEMALE EMPLOYMENT RATE]) AS FEMALE_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[SELF EMPLOYMENT RATE])  AS SELF_EMPLOYMENT_RATE,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE])AS ECONOMICALLY_INACTIVE,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE MALES]) AS ECONOMICALLY_INACTIVE_MALES,\n\t\tCONVERT(FLOAT,[ECONOMICALLY INACTIVE FEMALES]) AS ECONOMICALLY_INACTIVE_FEMALES,\n\t\tCONVERT(FLOAT,[NVQ LEVEL 4 QUALIFICATIONS])  AS NVQ_LEVEL_4_QUALIFICATIONS,\n\t\tCONVERT(FLOAT,[NVQ No qualifications])  AS NVQ_No_qualifications\n FROM KNE_STG.POSTCODE_TRAVEL_TO_WORK A",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_DETAILS",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "WARDNAME",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "WARDNAME",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "LOCAL_AUTHORITY",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "LOCAL_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PARL_CONSTIT",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "PARL_CONSTIT",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "COUNTY",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "COUNTY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "REGION",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "REGION",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "COUNTRY",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "COUNTRY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_INTEGRATED_CARE_BOARD",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NHS_INTEGRATED_CARE_BOARD",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_REGION",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NHS_REGION",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_CLINICAL_COMM_GROUP",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NHS_CLINICAL_COMM_GROUP",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NATIONAL_PARK",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "NATIONAL_PARK",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "POLICE_AUTHORITY",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "POLICE_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EMPLOYMENT_RATE",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "MALE_EMPLOYMENT_RATE",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "MALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "FEMALE_EMPLOYMENT_RATE",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "FEMALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "SELF_EMPLOYMENT_RATE",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "SELF_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "ECONOMICALLY_INACTIVE",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "ECONOMICALLY_INACTIVE_MALES",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "MALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "ECONOMICALLY_INACTIVE_FEMALES",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "FEMALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "NVQ_LEVEL_4_QUALIFICATIONS",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "NVQ_LVL4_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "NVQ_No_qualifications",
									"type": "Double",
									"physicalType": "float"
								},
								"sink": {
									"name": "NVQ_NO_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "LATITUDE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "LATITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								}
							},
							{
								"source": {
									"name": "LONGDITUDE",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "LONGDITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_AzureDB",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_DETAILS",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCode",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "NSPL21_MAY_2024_UK.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODES",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODES",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeCountry",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeCountry.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_COUNTRY",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_COUNTRY",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "CD_PRS_POSTCODE_DETAILS",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "CD_STG_POSTCODE_DETAILS",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "SELECT DISTINCT \n       [POSTCODE]\n      ,[WARDNAME]\n      ,[LOCAL_AUTHORITY]\n      ,[PARL_CONSTIT]\n      ,[COUNTY]\n      ,[REGION]\n      ,[COUNTRY]\n      ,[NHS_INTEGRATED_CARE_BOARD]\n      ,[NHS_REGION]\n      ,[NHS_CLINICAL_COMM_GROUP]\n      ,[NATIONAL_PARK]\n      ,[POLICE_AUTHORITY]\n      ,[EMPLOYMENT_RATE]\n      ,[MALE_EMPLOYMENT_RATE]\n      ,[FEMALE_EMPLOYMENT_RATE]\n      ,[SELF_EMPLOYMENT_RATE]\n      ,[ECON_INACTIVE_RATE]\n      ,[MALE_ECON_INACTIVE_RATE]\n      ,[FEMALE_ECON_INACTIVE_RATE]\n      ,[NVQ_LVL4_QUALS]\n      ,[NVQ_NO_QUALS]\n      ,[LATITUDE]\n      ,[LONGDITUDE]\n  FROM [KNE_STG].[POSTCODE_DETAILS]",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_PRS.POSTCODE_DETAILS",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "WARDNAME",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "WARDNAME",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "LOCAL_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "LOCAL_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "PARL_CONSTIT",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "PARL_CONSTIT",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "COUNTY",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "COUNTY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "REGION",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "REGION",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "COUNTRY",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "COUNTRY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_INTEGRATED_CARE_BOARD",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NHS_INTEGRATED_CARE_BOARD",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_REGION",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NHS_REGION",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NHS_CLINICAL_COMM_GROUP",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NHS_CLINICAL_COMM_GROUP",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "NATIONAL_PARK",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "NATIONAL_PARK",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "POLICE_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								},
								"sink": {
									"name": "POLICE_AUTHORITY",
									"type": "String",
									"physicalType": "varchar"
								}
							},
							{
								"source": {
									"name": "EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "MALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "MALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "FEMALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "FEMALE_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "SELF_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "SELF_EMPLOYMENT_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "MALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "MALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "FEMALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "FEMALE_ECON_INACTIVE_RATE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "NVQ_LVL4_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "NVQ_LVL4_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "NVQ_NO_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								},
								"sink": {
									"name": "NVQ_NO_QUALS",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 1,
									"precision": 4
								}
							},
							{
								"source": {
									"name": "LATITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								},
								"sink": {
									"name": "LATITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								}
							},
							{
								"source": {
									"name": "LONGDITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								},
								"sink": {
									"name": "LONGDITUDE",
									"type": "Decimal",
									"physicalType": "decimal",
									"scale": 6,
									"precision": 9
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_DETAILS",
							"SchemaName": "KNE_STG"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_DETAILS",
							"SchemaName": "KNE_PRS"
						}
					}
				]
			},
			{
				"name": "PostCodeParlConstiUpdate2024",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeParliamentaryConstituencies2024.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_PARL_CONSTIT_2024",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "POSTCODE",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "PCON24",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "PCON24",
									"type": "String",
									"physicalType": "nvarchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_PARL_CONSTIT_2024",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeMetroCounties",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "PostCodeCounties",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeMetropolitanCounties.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "MCTY21CD",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "CTY15CD",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "MCTY21NM",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "CTY15NM",
									"type": "String",
									"physicalType": "nvarchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_COUNTIES",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeWards",
				"type": "Copy",
				"dependsOn": [],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "POSTCODEWARD.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_WARDS_NOT_LONDON",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_WARDS_NOT_LONDON",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeWardsLondon",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "PostCodeWards",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "DelimitedTextSource",
						"storeSettings": {
							"type": "FileServerReadSettings",
							"recursive": true,
							"enablePartitionDiscovery": false,
							"fileFilter": "PostCodeWardsLondon.csv"
						},
						"formatSettings": {
							"type": "DelimitedTextReadSettings"
						}
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_WARDS_LONDON",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"tableOption": "autoCreate",
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "GEOGCD",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "WD21CD",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "GEOGNM",
									"type": "String",
									"physicalType": "String"
								},
								"sink": {
									"name": "WD21NM",
									"type": "String",
									"physicalType": "nvarchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_KNE_POSTCODES",
						"type": "DatasetReference"
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_WARDS_LONDON",
							"SchemaName": "KNE_STG"
						}
					}
				]
			},
			{
				"name": "PostCodeWardsComplete",
				"type": "Copy",
				"dependsOn": [
					{
						"activity": "PostCodeWardsLondon",
						"dependencyConditions": [
							"Succeeded"
						]
					}
				],
				"policy": {
					"timeout": "0.12:00:00",
					"retry": 0,
					"retryIntervalInSeconds": 30,
					"secureOutput": false,
					"secureInput": false
				},
				"userProperties": [],
				"typeProperties": {
					"source": {
						"type": "AzureSqlSource",
						"sqlReaderQuery": "\n  Select NL.WD21CD,NL.WD21NM\n  FROM KNE_STG.POSTCODE_WARDS_NOT_LONDON NL\n  WHERE NL.WD21CD NOT IN \n  (Select L.WD21CD\n  FROM KNE_STG.POSTCODE_WARDS_LONDON L)\n  UNION\n  Select L.WD21CD,L.WD21NM\n  FROM KNE_STG.POSTCODE_WARDS_LONDON L\n  WHERE L.WD21CD NOT IN \n  (Select NL.WD21CD\n  FROM KNE_STG.POSTCODE_WARDS_NOT_LONDON NL)",
						"queryTimeout": "02:00:00",
						"partitionOption": "None"
					},
					"sink": {
						"type": "AzureSqlSink",
						"preCopyScript": "TRUNCATE TABLE KNE_STG.POSTCODE_WARDS",
						"writeBehavior": "insert",
						"sqlWriterUseTableLock": false,
						"disableMetricsCollection": false
					},
					"enableStaging": false,
					"translator": {
						"type": "TabularTranslator",
						"mappings": [
							{
								"source": {
									"name": "WD21CD",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "WD21CD",
									"type": "String",
									"physicalType": "nvarchar"
								}
							},
							{
								"source": {
									"name": "WD21NM",
									"type": "String",
									"physicalType": "nvarchar"
								},
								"sink": {
									"name": "WD21NM",
									"type": "String",
									"physicalType": "nvarchar"
								}
							}
						],
						"typeConversion": true,
						"typeConversionSettings": {
							"allowDataTruncation": true,
							"treatBooleanAsNumber": false
						}
					}
				},
				"inputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_WARDS_LONDON",
							"SchemaName": "KNE_STG"
						}
					}
				],
				"outputs": [
					{
						"referenceName": "DS_Azure_Destination",
						"type": "DatasetReference",
						"parameters": {
							"TableName": "POSTCODE_WARDS",
							"SchemaName": "KNE_STG"
						}
					}
				]
			}
		],
		"folder": {
			"name": "POSTCODES"
		},
		"annotations": []
	}
}